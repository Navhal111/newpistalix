!function(t){t.isScrollToFixed=function(e){return!!t(e).data("ScrollToFixed")},t.ScrollToFixed=function(e,i){function o(){C.trigger("preUnfixed.ScrollToFixed"),c(),C.trigger("unfixed.ScrollToFixed"),_=-1,$=C.offset().top,T=C.offset().left,g.options.offsets&&(T+=C.offset().left-C.position().left),-1==S&&(S=T),v=C.css("position"),x=!0,-1!=g.options.bottom&&(C.trigger("preFixed.ScrollToFixed"),l(),C.trigger("fixed.ScrollToFixed"))}function n(){var t=g.options.limit
return t?"function"==typeof t?t.apply(C):t:0}function s(){return"fixed"===v}function r(){return"absolute"===v}function a(){return!(s()||r())}function l(){s()||(A.css({display:C.css("display"),width:C.outerWidth(!0),height:C.outerHeight(!0),"float":C.css("float")}),cssOptions={"z-index":g.options.zIndex,position:"fixed",top:-1==g.options.bottom?u():"",bottom:-1==g.options.bottom?"":g.options.bottom,"margin-left":"0px"},g.options.dontSetWidth||(cssOptions.width=C.width()),C.css(cssOptions),C.addClass(g.options.baseClassName),g.options.className&&C.addClass(g.options.className),v="fixed")}function h(){var t=n(),e=T
g.options.removeOffsets&&(e="",t-=$),cssOptions={position:"absolute",top:t,left:e,"margin-left":"0px",bottom:""},g.options.dontSetWidth||(cssOptions.width=C.width()),C.css(cssOptions),v="absolute"}function c(){a()||(_=-1,A.css("display","none"),C.css({"z-index":w,width:"",position:y,left:"",top:b,"margin-left":""}),C.removeClass("scroll-to-fixed-fixed"),g.options.className&&C.removeClass(g.options.className),v=null)}function d(t){t!=_&&(C.css("left",T-t),_=t)}function u(){var t=g.options.marginTop
return t?"function"==typeof t?t.apply(C):t:0}function p(){if(t.isScrollToFixed(C)){var e=x
x?a()&&($=C.offset().top,T=C.offset().left):o()
var i=t(window).scrollLeft(),p=t(window).scrollTop(),v=n()
g.options.minWidth&&t(window).width()<g.options.minWidth?a()&&e||(m(),C.trigger("preUnfixed.ScrollToFixed"),c(),C.trigger("unfixed.ScrollToFixed")):g.options.maxWidth&&t(window).width()>g.options.maxWidth?a()&&e||(m(),C.trigger("preUnfixed.ScrollToFixed"),c(),C.trigger("unfixed.ScrollToFixed")):-1==g.options.bottom?v>0&&p>=v-u()?r()&&e||(m(),C.trigger("preAbsolute.ScrollToFixed"),h(),C.trigger("unfixed.ScrollToFixed")):p>=$-u()?(s()&&e||(m(),C.trigger("preFixed.ScrollToFixed"),l(),_=-1,C.trigger("fixed.ScrollToFixed")),d(i)):a()&&e||(m(),C.trigger("preUnfixed.ScrollToFixed"),c(),C.trigger("unfixed.ScrollToFixed")):v>0?p+t(window).height()-C.outerHeight(!0)>=v-(u()||-f())?s()&&(m(),C.trigger("preUnfixed.ScrollToFixed"),"absolute"===y?h():c(),C.trigger("unfixed.ScrollToFixed")):(s()||(m(),C.trigger("preFixed.ScrollToFixed"),l()),d(i),C.trigger("fixed.ScrollToFixed")):d(i)}}function f(){return g.options.bottom?g.options.bottom:0}function m(){var t=C.css("position")
"absolute"==t?C.trigger("postAbsolute.ScrollToFixed"):"fixed"==t?C.trigger("postFixed.ScrollToFixed"):C.trigger("postUnfixed.ScrollToFixed")}var g=this
g.$el=t(e),g.el=e,g.$el.data("ScrollToFixed",g)
var v,y,b,w,x=!1,C=g.$el,$=0,T=0,S=-1,_=-1,A=null,k=function(t){C.is(":visible")&&(x=!1,p())},F=function(t){window.requestAnimationFrame?requestAnimationFrame(p):p()},E=function(t){t=t||window.event,t.preventDefault&&t.preventDefault(),t.returnValue=!1}
g.init=function(){g.options=t.extend({},t.ScrollToFixed.defaultOptions,i),w=C.css("z-index"),g.$el.css("z-index",g.options.zIndex),A=t("<div />"),v=C.css("position"),y=C.css("position"),b=C.css("top"),a()&&g.$el.after(A),t(window).bind("resize.ScrollToFixed",k),t(window).bind("scroll.ScrollToFixed",F),"ontouchmove"in window&&t(window).bind("touchmove.ScrollToFixed",p),g.options.preFixed&&C.bind("preFixed.ScrollToFixed",g.options.preFixed),g.options.postFixed&&C.bind("postFixed.ScrollToFixed",g.options.postFixed),g.options.preUnfixed&&C.bind("preUnfixed.ScrollToFixed",g.options.preUnfixed),g.options.postUnfixed&&C.bind("postUnfixed.ScrollToFixed",g.options.postUnfixed),g.options.preAbsolute&&C.bind("preAbsolute.ScrollToFixed",g.options.preAbsolute),g.options.postAbsolute&&C.bind("postAbsolute.ScrollToFixed",g.options.postAbsolute),g.options.fixed&&C.bind("fixed.ScrollToFixed",g.options.fixed),g.options.unfixed&&C.bind("unfixed.ScrollToFixed",g.options.unfixed),g.options.spacerClass&&A.addClass(g.options.spacerClass),C.bind("resize.ScrollToFixed",function(){A.height(C.height())}),C.bind("scroll.ScrollToFixed",function(){C.trigger("preUnfixed.ScrollToFixed"),c(),C.trigger("unfixed.ScrollToFixed"),p()}),C.bind("detach.ScrollToFixed",function(e){E(e),C.trigger("preUnfixed.ScrollToFixed"),c(),C.trigger("unfixed.ScrollToFixed"),t(window).unbind("resize.ScrollToFixed",k),t(window).unbind("scroll.ScrollToFixed",F),C.unbind(".ScrollToFixed"),A.remove(),g.$el.removeData("ScrollToFixed")}),k()},g.init()},t.ScrollToFixed.defaultOptions={marginTop:0,limit:0,bottom:-1,zIndex:1e3,baseClassName:"scroll-to-fixed-fixed"},t.fn.scrollToFixed=function(e){return this.each(function(){new t.ScrollToFixed(this,e)})}}(jQuery)